<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>caoshen - caoshen 的博客</title><meta name="author" content="caoshen"><meta name="copyright" content="caoshen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta property="og:type" content="website">
<meta property="og:title" content="caoshen">
<meta property="og:url" content="https://www.okclouder.cn/page/5/index.html">
<meta property="og:site_name" content="caoshen">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://avatars2.githubusercontent.com/u/3806787?s=460&u=ee280a9fc6c98bc591f30ffbf10360a9ac3822ff&v=4">
<meta property="article:author" content="caoshen">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://avatars2.githubusercontent.com/u/3806787?s=460&u=ee280a9fc6c98bc591f30ffbf10360a9ac3822ff&v=4"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.okclouder.cn/page/5/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2020-11-30 22:29:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="caoshen" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/3806787?s=460&amp;u=ee280a9fc6c98bc591f30ffbf10360a9ac3822ff&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">151</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(https://pic1.zhimg.com/80/v2-53cf7b4f3782749070a4207dd4d4888b_1440w.jpeg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">caoshen</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site-title">caoshen</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/caoshen" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/11/27/View%20%E7%9A%84%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/" title="无题">     <img class="post_bg" src="https://pic1.zhimg.com/80/v2-1fb9faa1ea61d40bed117604673486ae_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/27/View%20%E7%9A%84%E7%BB%98%E5%88%B6%E6%B5%81%E7%A8%8B/" title="无题">无题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-27T00:56:17.765Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></span></div><div class="content">View 的绘制流程View 的绘制流程其实就是 View 的 measure\layout\draw 过程，分别对应测量、布局和绘制。
ViewRootViewRoot 对于 ViewRootImpl 类，他是连接 WindowManager 和 DecorView 的桥梁。View 的三大流程都是通过 ViewRoot 完成的。在 ActivityThread 类中，activity 创建完毕后，会将 Decorview 添加到 Window 中，同时创建 ViewRootImpl 对象，并将 ViewRootImpl 和 DecorView 关联。
View 的绘制流程是从 ViewRootImpl 的 performTraversals 开始的，经过了 measure、layout、draw 三个过程，才能最终将一个 View 绘制出来。
measure 过程结束后，可以通过 getMeasuredWith 和 getMeasuredHeight 拿到 View 的测量宽高，在几乎所有的情况下都等同于 View 的最终宽高。除了在 layout 过程中修改了左上右下四个顶点的位 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/11/27/view%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6/" title="无题">     <img class="post_bg" src="https://pic1.zhimg.com/80/v2-53cf7b4f3782749070a4207dd4d4888b_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/27/view%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E6%9C%BA%E5%88%B6/" title="无题">无题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-27T00:56:17.765Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></span></div><div class="content">view 的事件分发机制当点击手机屏幕时，会产生点击事件，这个事件就是MotionEvent。view系统有一套事件分发机制，决定由哪一个 view 处理点击事件。
事件分发由三个重要的方法：

dispatchTouchEvent 事件分发
onInterceptTouchEvent 事件拦截
onTouchEvent 事件处理

事件的传递过程是由上至下传递。点击事件会依次传递给 Activity -&gt; PhoneWindow -&gt; DecorView -&gt; ContentView -&gt; ViewGroup。
dispatchTouchEvent 方法12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970@Overridepublic boolean dispatchTouchEvent(MotionEvent ev) &#123;    ...     ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/11/27/RxJava%20%E7%BA%BF%E7%A8%8B%E6%8E%A7%E5%88%B6/" title="无题">     <img class="post_bg" src="https://pic1.zhimg.com/80/v2-1fb9faa1ea61d40bed117604673486ae_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/27/RxJava%20%E7%BA%BF%E7%A8%8B%E6%8E%A7%E5%88%B6/" title="无题">无题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-27T00:56:17.764Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></span></div><div class="content">RxJava 线程控制RxJava 可以切换调度线程，控制每个操作在哪个线程执行。
RxJava 内置的 Scheduler如果我们不指定线程，默认是在调用 subscribe 方法的线程上进行回调的。如果想切换线程，就需要使用调度器（Scheduler）。RxJava 内置了如下 5 个 Scheduler。

Schedulers.immediate：直接在当前线程运行，它是 timeout、timeInterval 和 timestamp 操作符的默认调度器。

Schedulers.newThread: 总是启用新线程，在新线程执行操作。

Schedulers.io：IO （读写文件、数据库、网络信息交互）所使用的 Scheduler。io 内部实现是一个无数量上限的线程池，可以重用空闲的线程。因此多数情况下 io 比 newThread 更有效率。

Schedulers.computation: 计算所使用的 Scheduler，例如图形的计算。这个 Scheduler 使用固定线程池，大小为 CPU 核。不要把 IO 操作放到 computation 种，否则 IO 操 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/11/27/Dagger2%20%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E7%9A%84%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/" title="无题">     <img class="post_bg" src="https://pic4.zhimg.com/80/v2-905b30ef749b15963046e9bd1d41f195_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/27/Dagger2%20%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E7%9A%84%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/" title="无题">无题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-27T00:56:17.761Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></span></div><div class="content">Dagger2 依赖注入的原理分析因为 Dagger2 的使用情况很多，这里只对基本的使用方法进行分析。
以一个简单依赖注入举例如下：
创建 Watch 类如下：
12345678910public class Watch &#123;    public Watch() &#123;    &#125;    public String work() &#123;        return &quot;work&quot;;    &#125;&#125;

创建 WatchModule 类如下：
12345678@Modulepublic class WatchModule &#123;    @Provides    public Watch providesWatch() &#123;        return new Watch();    &#125;&#125;

创建 Component 接口如下：
1234@Component(modules = WatchModule.class)public interface WatchComponent &#123;    ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/11/27/Android%20%E4%B8%BB%E7%BA%BF%E7%A8%8B%E4%B8%8ELooper.loop()%20%E5%BE%AA%E7%8E%AF/" title="无题">     <img class="post_bg" src="https://pic2.zhimg.com/80/v2-de84195207d783e0ed3bfb99f151f23e_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/27/Android%20%E4%B8%BB%E7%BA%BF%E7%A8%8B%E4%B8%8ELooper.loop()%20%E5%BE%AA%E7%8E%AF/" title="无题">无题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-27T00:56:17.760Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></span></div><div class="content">Android 主线程与Looper.loop() 循环Android中为什么主线程不会因为Looper.loop()里的死循环卡死？这是一个知乎上的问题，链接如下：
https://www.zhihu.com/question/34652589
要回答这个问题，需要涉及一些知识，比如 Looper、Handler、AcitivityThread、Binder 等。
主线程消息循环众所周知，在 ActivityThread 类的 main 方法中，通过 Looper.prepareMainLooper();准备主线程的 looper，通过 Looper.loop(); 开启消息循环。假设主线程中的消息循环不是无限循环，而是过一段时间退出了，那么会导致程序退出，功能异常，就像当前正在前台交互的界面突然消失，这显然不是想看到的场景。因此开启一个无限循环，保证程序一直运行，如果有收到消息就处理，如果没有收到消息就休眠，直到被下一个消息唤醒。
真正导致主线程卡住的是处理某一个消息耗时太长，导致阻塞了其他消息，其他消息得不到处理，出现 ANR 问题（应用不响应 Application Not R ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/11/27/VirtualAPK%20%E6%8F%92%E4%BB%B6%E5%8C%96%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/" title="无题">     <img class="post_bg" src="https://pic4.zhimg.com/80/v2-905b30ef749b15963046e9bd1d41f195_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/27/VirtualAPK%20%E6%8F%92%E4%BB%B6%E5%8C%96%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/" title="无题">无题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-27T00:56:17.759Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></span></div><div class="content">VirtualAPK 插件化原理分析这里以 VirtualAPK 0.9.8 版本为例，从三个方面介绍 VirtualAPK 的插件化原理。

VirtualAPK 如何加载插件 APK 的类
VirtualAPK 如何解决宿主 APK 和插件 APK 的冲突
VirtualAPK 如何支持四大组件

VirtualAPK 插件类的加载VirtualAPK 从外部存储读取到插件 APK 后，调用了 PluginManager 的 loadPlugin 的方法加载插件 APK。
12File plugin = new File(pluginPath);PluginManager.getInstance(this).loadPlugin(plugin);

PluginManager 的 loadPlugin 方法如下：
123456789    public void loadPlugin(File apk) throws Exception &#123;...        LoadedPlugin plugin = createLoadedPlugin(apk);           ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/11/27/Java%20%E6%B3%A8%E8%A7%A3%E4%B8%8E%E6%B3%A8%E8%A7%A3%E5%A4%84%E7%90%86%E5%99%A8/" title="无题">     <img class="post_bg" src="https://pic1.zhimg.com/80/v2-53cf7b4f3782749070a4207dd4d4888b_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/27/Java%20%E6%B3%A8%E8%A7%A3%E4%B8%8E%E6%B3%A8%E8%A7%A3%E5%A4%84%E7%90%86%E5%99%A8/" title="无题">无题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-27T00:56:17.758Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></span></div><div class="content">Java 注解与注解处理器从 JDK 5 开始，Java 增加了注解，注解是代码里面的特殊标记，这些标记可以在编译、类加载、运行时被读取，并执行一些相应的处理。通过使用注解，开发人员可以在不改变原有逻辑的情况下，在源文件中嵌入一些补充的信息。代码分析工具、开发工具和部署工具可以通过这些补充信息进行验证、处理或者进行部署。
注解注解可以分为标准注解和元注解。
标准注解是 JDK 自带的注解。元注解是用来注解其他注解的注解。
标准注解标准注解由以下 4 种：

@Override 重写注解。对覆盖超类中的方法进行标记，如果被标记的方法没有实际覆盖超类中的方法，编译器会发出警告。
@Deprecated 过时注解。对不鼓励使用或者已经过时的方法添加注解。当编程人员在使用这些方法时，会在编译时显示提示信息。
@SuppressWarnings 取消警告注解。选择性地取消特定代码段中的警告，比如 lint 警告。
@SafeVarargs JDK 7 新增，用来声明使用了可变长度参数的方法，其在与泛型类一起使用时不会出现类型安全的问题。

元注解除了标准注解，还有元注解，它用来注解其他注解，从而 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/11/27/ButterKnife%20View%20%E6%B3%A8%E8%A7%A3%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/" title="无题">     <img class="post_bg" src="https://pic4.zhimg.com/80/v2-905b30ef749b15963046e9bd1d41f195_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/27/ButterKnife%20View%20%E6%B3%A8%E8%A7%A3%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/" title="无题">无题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-27T00:56:17.756Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></span></div><div class="content">ButterKnife View 注解框架介绍ButterKnife 是 Android 系统的 View 注入框架，它可以减少大量的 findViewById 以及 setOnClickListener 代码，简化代码并提升开发效率。
但是，Google 官方提倡的 View Binding (MVVM) 架构也可以起到相同的作用。
正如 ButterKnife 的作者所说：
1Attention: Development on this tool is winding down. Please consider switching to view binding in the coming months.

大致意思是 ButterKnife 的开发将变缓，后续请考虑迁移到 view binding 架构。
添加 ButterKnife 依赖在 app 模块的 build.gradle 文件添加依赖如下：
123456dependencies &#123;...    &#x2F;&#x2F; butterknife    implementation &#39;com.jakew ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/11/27/Retrofit%20%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" title="无题">     <img class="post_bg" src="https://pic2.zhimg.com/80/v2-de84195207d783e0ed3bfb99f151f23e_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/27/Retrofit%20%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" title="无题">无题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-27T00:56:17.754Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></span></div><div class="content">Retrofit 源码分析这里以 retrofit2.6.1 版本为例，从 3 个方面分析 Retrofit 的源代码：

Retrofit 创建；
Call 创建；
Call 入队（enqueue）.

Retrofit 的创建使用 Retrofit 的时候，首先会用建造者模式构造 Retrofit。
1234Retrofit retrofit = new Retrofit.Builder()                .baseUrl(IP_TAOBAO_SERVICE)                .addConverterFactory(GsonConverterFactory.create())                .build();

Platform 构造Builder 的无参构造方法调用了 Platform.get()。获取一个 Platform，然后作为参数传递给构造方法。
123public Builder() &#123;  this(Platform.get());&#125;

Platform 的 get 方法是单例模式，返回 Platfor ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/11/27/AsyncTask%20%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1/" title="无题">     <img class="post_bg" src="https://pic1.zhimg.com/80/v2-ae3e138bac66bc9e3081c035d27dcfd9_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/27/AsyncTask%20%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1/" title="无题">无题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-27T00:56:17.752Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></span></div><div class="content">AsyncTask 异步任务AsyncTask 是 Android 的异步任务类，它本质上是对 Thread 和 Handler 的封装，达到工作线程执行异步任务，执行完毕后切换到主线程的功能。
AsyncTask 的执行顺序以 SDK 28 为例，默认情况下，调用 execute 方法，AsyncTask 的任务都是串行的。比如有 10 个 AsyncTask 同时开始执行，实际上当前一个 AsyncTask 执行完毕后，下一个AsyncTask 才会真正开始执行。
1234@MainThreadpublic final AsyncTask&lt;Params, Progress, Result&gt; execute(Params... params) &#123;    return executeOnExecutor(sDefaultExecutor, params);&#125;

以上代码可以看出，默认使用了 sDefaultExecutor 来执行异步任务。
1private static volatile Executor sDefaultExecutor = SERI ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/4/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/6/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/3806787?s=460&amp;u=ee280a9fc6c98bc591f30ffbf10360a9ac3822ff&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">caoshen</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">151</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/caoshen"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/caoshen" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">hello</div></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2020/11/27/Java%20%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97/" title="无题"><img src="https://pic1.zhimg.com/80/v2-ae3e138bac66bc9e3081c035d27dcfd9_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2020/11/27/Java%20%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97/" title="无题">无题</a><time datetime="2020-11-27T00:56:17.811Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/27/Android%20RxJava%20%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" title="无题"><img src="https://pic1.zhimg.com/80/v2-53cf7b4f3782749070a4207dd4d4888b_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2020/11/27/Android%20RxJava%20%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/" title="无题">无题</a><time datetime="2020-11-27T00:56:17.810Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/27/Java%20volatile%20%E5%85%B3%E9%94%AE%E5%AD%97/" title="无题"><img src="https://pic1.zhimg.com/80/v2-1fb9faa1ea61d40bed117604673486ae_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2020/11/27/Java%20volatile%20%E5%85%B3%E9%94%AE%E5%AD%97/" title="无题">无题</a><time datetime="2020-11-27T00:56:17.810Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/27/ContentProvider%20%E9%9A%BE%E7%82%B9/" title="无题"><img src="https://pic1.zhimg.com/80/v2-ae3e138bac66bc9e3081c035d27dcfd9_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2020/11/27/ContentProvider%20%E9%9A%BE%E7%82%B9/" title="无题">无题</a><time datetime="2020-11-27T00:56:17.809Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/27/OkHttp%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="无题"><img src="https://pic1.zhimg.com/80/v2-53cf7b4f3782749070a4207dd4d4888b_1440w.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2020/11/27/OkHttp%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="无题">无题</a><time datetime="2020-11-27T00:56:17.809Z" title="发表于 2020-11-27 08:56:17">2020-11-27</time></div></div></div></div></div><div class="card-widget card-categories"><div class="card-content"><div class="item-headline"><i class="fas fa-folder-open"></i><span>分类</span></div><ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Android/"><span class="card-category-list-name">Android</span><span class="card-category-list-count">33</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Kotlin/"><span class="card-category-list-name">Kotlin</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%AE%97%E6%B3%95/"><span class="card-category-list-name">算法</span><span class="card-category-list-count">33</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%93%9D%E7%89%99/"><span class="card-category-list-name">蓝牙</span><span class="card-category-list-count">7</span></a></li>
            
            </ul></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/BFS/" style="font-size: 1.1em; color: #999">BFS</a> <a href="/tags/BLE/" style="font-size: 1.1em; color: #999">BLE</a> <a href="/tags/BLE%E5%B9%BF%E6%92%AD/" style="font-size: 1.1em; color: #999">BLE广播</a> <a href="/tags/Gradle/" style="font-size: 1.39em; color: #99a4b4">Gradle</a> <a href="/tags/IPC/" style="font-size: 1.1em; color: #999">IPC</a> <a href="/tags/Kotlin/" style="font-size: 1.21em; color: #999ea4">Kotlin</a> <a href="/tags/Kotlin%E6%A0%87%E5%87%86%E5%BA%93/" style="font-size: 1.1em; color: #999">Kotlin标准库</a> <a href="/tags/Proguard/" style="font-size: 1.1em; color: #999">Proguard</a> <a href="/tags/View/" style="font-size: 1.1em; color: #999">View</a> <a href="/tags/%E5%9B%BE/" style="font-size: 1.1em; color: #999">图</a> <a href="/tags/%E6%95%B0%E7%BB%84/" style="font-size: 1.33em; color: #99a2af">数组</a> <a href="/tags/%E6%A0%88/" style="font-size: 1.1em; color: #999">栈</a> <a href="/tags/%E6%A0%91/" style="font-size: 1.27em; color: #99a0a9">树</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.5em; color: #99a9bf">算法</a> <a href="/tags/%E8%93%9D%E7%89%99/" style="font-size: 1.27em; color: #99a0a9">蓝牙</a> <a href="/tags/%E8%93%9D%E7%89%99Profile/" style="font-size: 1.1em; color: #999">蓝牙Profile</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 1.44em; color: #99a7ba">设计模式</a> <a href="/tags/%E9%80%92%E5%BD%92/" style="font-size: 1.1em; color: #999">递归</a> <a href="/tags/%E9%93%BE%E8%A1%A8/" style="font-size: 1.16em; color: #999b9e">链表</a> <a href="/tags/%E9%95%9C%E5%83%8F/" style="font-size: 1.1em; color: #999">镜像</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/11/"><span class="card-archive-list-date">十一月 2020</span><span class="card-archive-list-count">63</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/10/"><span class="card-archive-list-date">十月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/09/"><span class="card-archive-list-date">九月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/08/"><span class="card-archive-list-date">八月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/06/"><span class="card-archive-list-date">六月 2020</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/05/"><span class="card-archive-list-date">五月 2020</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/04/"><span class="card-archive-list-date">四月 2020</span><span class="card-archive-list-count">9</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/03/"><span class="card-archive-list-date">三月 2020</span><span class="card-archive-list-count">12</span></a></li><li class="card-archive-list-item more is-center"><a class="card-archive-list-link-more" href="/archives/">
              <span>查看更多</span><i class="fas fa-angle-right"  ></i></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">151</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2020-11-30T14:29:49.241Z"></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 By caoshen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><span>鄂ICP备18020323号</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>